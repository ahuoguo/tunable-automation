# Tunable Automation

Artifact for the paper "Tunable Automation in Automated Program Verification"

## Dependencies

We require a working version of `rustup`, `python3`, `ninja`, as Verus and Mariposa depend on them.

## Installation

Clone this repo with the following:

```
git clone https://github.com/ahuoguo/tunable-automation.git
cd tunable-automation
git submodule update --init --remote --filter=blob:none
```

## Minimizing Verus Projects

We do not include scripts to minimize several Verus project as they can take days. We provide the logs and minimized projects under `experiments/minimized`, the minimized projects after broadcasting.

Here's the path of the logs for minimization:

```
./broadcast-from-main/anvil/src/min-after-brd.log
./broadcast-from-main/verified-betrfs/Splinter/src/min-after-brd.log
./broadcast-from-main/verified-ironkv/ironsht/src/min.log
./minimized/anvil/src/min.log
./minimized/verified-ironkv/ironsht/src/min.log
./minimized/verified-betrfs/Splinter/src/min.log
./all-triggers/verified-ironkv-min/ironsht/src/min-at.log
./broadcast-from-main/verified-storage/osdi25/capybaraKV/brd-from-main.log1
./minimized/verified-storage/osdi25/capybaraKV/capybarakv/src/deps_hack/min.log1
```

### Running Minimization by Yourself

The VerusMinimizer corresponding to each project is in the `verus/` folder. An example to use VerusMinimizer is

```
cd verus/minimizer/source/tools/minimize
cargo run --release -- -d ./tmp <path-to-tunable-automation>/experiments/original/verified-ironkv/ironsht/src/lib.d
```

Here, the `lib.d` file is generated by running Verus on the project with the `--emit=dep-info` flag. See more details in the `run.sh` script.

Since Anvil and VerifiedStorage needs their own `deps_hack` folder, we provide separate VerusMinimizer for them.

## Table 2

The VerusMinimizer can also count the number of asserts

```
cd verus/minimizer/source/tools/minimize 
cargo run --release -- -n <path-to-tunable-automation>/experiments/original/verified-ironkv/ironsht/src/lib.d

```

## Figure 3 Verification Time Ratio

The time logs can be replicated by `experiments/run.sh`. It will generate a `<project-name>.json` file in `experiments/original`, `experiments/minimized`, and `experiments/braodcast-from-main`.

Then running go to `json-time-cmp/` and run `generate-grphs.sh`.


## Figure 4

```
cd failure-sample
./run.sh
./generate-graph.sh
cd -
```

## Figure 5
```
cd ./experiments/all-triggers/
./run.sh
cd ../json-time-cmp
python plot.py ../experiments/all-triggers/ironkv_at_min.json ../experiments/original/ironkv.json
cd ../failure-sample
python ./plot-all-scatter.py . all_triggers all_triggers
```

